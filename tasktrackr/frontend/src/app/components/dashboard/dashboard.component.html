<div class="dashboard-container">
  <div class="welcome-section">
    <h2>Welcome, {{ user?.name || 'User' }}!</h2>
    <p>Here's your task overview for today: {{ today | date:'fullDate' }}</p>
  </div>
  
  <div class="dashboard-stats">
    <div class="stat-card">
      <div class="stat-icon">üìù</div>
      <div class="stat-content">
        <h3>Total Tasks</h3>
        <p class="stat-value">{{ totalTasks }}</p>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">‚úÖ</div>
      <div class="stat-content">
        <h3>Completed</h3>
        <p class="stat-value">{{ completedTasks }}</p>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">üìä</div>
      <div class="stat-content">
        <h3>Completion Rate</h3>
        <p class="stat-value">{{ completionRate }}%</p>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">‚ö†Ô∏è</div>
      <div class="stat-content">
        <h3>Overdue</h3>
        <p class="stat-value">{{ overdueTasks.length }}</p>
      </div>
    </div>
  </div>
  
  <div class="dashboard-grid">
    <!-- Upcoming Tasks Section -->
    <div class="dashboard-card">
      <div class="card-header">
        <h3>Upcoming Tasks</h3>
        <a routerLink="/tasks" class="view-all">View All</a>
      </div>
      
      <div class="card-content">
        <div *ngIf="loading.upcoming" class="loading-indicator">
          <p>Loading tasks...</p>
        </div>
        
        <div *ngIf="!loading.upcoming && upcomingTasks.length === 0" class="empty-state">
          <p>No upcoming tasks in the next 3 days.</p>
          <button routerLink="/tasks/new" class="create-task-button">Create a Task</button>
        </div>
        
        <div *ngIf="!loading.upcoming && upcomingTasks.length > 0" class="task-list">
          <div *ngFor="let task of upcomingTasks" class="task-item">
            <div class="task-checkbox">
              <input type="checkbox" [checked]="task.isCompleted" (change)="toggleTaskCompletion(task)">
            </div>
            <div class="task-details">
              <h4>{{ task.title }}</h4>
              <p class="task-date">
                <span [class.overdue]="task.deadline < today">Due: {{ formatDate(task.deadline) }}</span>
                <span class="task-priority {{ task.priority }}">{{ task.priority }}</span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Overdue Tasks Section -->
    <div class="dashboard-card">
      <div class="card-header">
        <h3>Overdue Tasks</h3>
      </div>
      
      <div class="card-content">
        <div *ngIf="loading.upcoming" class="loading-indicator">
          <p>Loading tasks...</p>
        </div>
        
        <div *ngIf="!loading.upcoming && overdueTasks.length === 0" class="empty-state">
          <p>No overdue tasks! You're all caught up.</p>
        </div>
        
        <div *ngIf="!loading.upcoming && overdueTasks.length > 0" class="task-list overdue-list">
          <div *ngFor="let task of overdueTasks" class="task-item">
            <div class="task-checkbox">
              <input type="checkbox" [checked]="task.isCompleted" (change)="toggleTaskCompletion(task)">
            </div>
            <div class="task-details">
              <h4>{{ task.title }}</h4>
              <p class="task-date">
                <span class="overdue">Due: {{ formatDate(task.deadline) }}</span>
                <span class="task-priority {{ task.priority }}">{{ task.priority }}</span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Recently Completed Section -->
    <div class="dashboard-card">
      <div class="card-header">
        <h3>Recently Completed</h3>
      </div>
      
      <div class="card-content">
        <div *ngIf="loading.completed" class="loading-indicator">
          <p>Loading tasks...</p>
        </div>
        
        <div *ngIf="!loading.completed && recentlyCompletedTasks.length === 0" class="empty-state">
          <p>You haven't completed any tasks yet.</p>
        </div>
        
        <div *ngIf="!loading.completed && recentlyCompletedTasks.length > 0" class="task-list completed-list">
          <div *ngFor="let task of recentlyCompletedTasks" class="task-item completed">
            <div class="task-checkbox">
              <input type="checkbox" [checked]="task.isCompleted" (change)="toggleTaskCompletion(task)">
            </div>
            <div class="task-details">
              <h4>{{ task.title }}</h4>
              <p class="task-date">
                <span>Completed: {{ formatDate(task.completedAt || today) }}</span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>