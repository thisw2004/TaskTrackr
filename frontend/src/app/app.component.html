<div class="app-container">
  <header *ngIf="isLoggedIn">
    <h1>{{ title }}</h1>
    <button (click)="logout()" class="logout-btn">Logout</button>
  </header>
  
  <router-outlet></router-outlet>
</div>

<!-- Keep your existing content - this will be moved to the dashboard component -->
<div class="container" *ngIf="isLoggedIn">
  <header>
    <h1>{{ title }}</h1>
    <p>Manage your tasks efficiently</p>
  </header>

  <!-- ADD TASK FORM - Always visible -->
  <div class="task-form-container">
    <h2>Add New Task</h2>
    <form (ngSubmit)="addTask()">
      <div class="form-group">
        <label for="taskTitle">Title*:</label>
        <input 
          type="text" 
          id="taskTitle" 
          required
          [(ngModel)]="newTask.title"
          name="title"
          placeholder="Task title"
        >
      </div>
      
      <div class="form-group">
        <label for="taskDesc">Description:</label>
        <textarea 
          id="taskDesc" 
          rows="3"
          [(ngModel)]="newTask.description"
          name="description"
          placeholder="Task description"
        ></textarea>
      </div>
      
      <div class="form-group">
        <label for="taskDeadline">Deadline*:</label>
        <input 
          type="date" 
          id="taskDeadline" 
          required
          [(ngModel)]="newTask.deadline"
          [min]="minDate"
          name="deadline"
        >
      </div>
      
      <div class="form-actions">
        <button type="submit" [disabled]="!newTask.title || !newTask.deadline">Add Task</button>
      </div>
    </form>
  </div>

  <!-- ACTIVE TASKS LIST -->
  <div class="task-list-container">
    <h2>Active Tasks</h2>
    <div *ngIf="getActiveTasks().length === 0" class="no-tasks">
      <p>No active tasks. Add your first task!</p>
    </div>
    
    <ul class="task-list">
      <li *ngFor="let task of getActiveTasks()" 
          [class.overdue]="isOverdue(task)"
          id="task-{{task.id}}">
        
        <!-- Regular Task View -->
        <div *ngIf="editingTask?.id !== task.id">
          <div class="task-header">
            <h3>{{ task.title }}</h3>
            <div class="task-actions">
              <button (click)="toggleComplete(task)">Complete</button>
              <button (click)="editTask(task)">Edit</button>
              <button (click)="deleteTask(task.id)">Delete</button>
            </div>
          </div>
          
          <p>{{ task.description }}</p>
          <div class="task-meta">
            <span [class.overdue]="isOverdue(task)">
              Deadline: {{ task.deadline | date:'mediumDate' }}
            </span>
            <span *ngIf="isOverdue(task)" class="overdue-label">OVERDUE!</span>
          </div>
        </div>
        
        <!-- Inline Edit Form -->
        <div *ngIf="editingTask?.id === task.id" class="inline-edit-form">
          <form (ngSubmit)="saveEditedTask()">
            <div class="form-group">
              <label for="editTaskTitle">Title*:</label>
              <input 
                type="text" 
                id="editTaskTitle" 
                required
                [(ngModel)]="editingTask!.title"
                name="title"
                placeholder="Task title"
              >
            </div>
            
            <div class="form-group">
              <label for="editTaskDesc">Description:</label>
              <textarea 
                id="editTaskDesc" 
                rows="3"
                [(ngModel)]="editingTask!.description"
                name="description"
                placeholder="Task description"
              ></textarea>
            </div>
            
            <div class="form-group">
              <label for="editTaskDeadline">Deadline*:</label>
              <input 
                type="date" 
                id="editTaskDeadline" 
                required
                [(ngModel)]="editingTask!.deadline"
                [min]="minDate"
                name="deadline"
              >
            </div>
            
            <div class="form-actions">
              <button type="submit" [disabled]="!editingTask!.title || !editingTask!.deadline">Save</button>
              <button type="button" class="secondary" (click)="cancelEdit()">Cancel</button>
            </div>
          </form>
        </div>
      </li>
    </ul>
  </div>

  <!-- COMPLETED TASKS LIST -->
  <div class="completed-task-container">
    <h2>Completed Tasks</h2>
    <div *ngIf="getCompletedTasks().length === 0" class="no-tasks">
      <p>No completed tasks yet.</p>
    </div>
    
    <ul class="task-list">
      <li *ngFor="let task of getCompletedTasks()" class="completed">
        <div class="task-header">
          <h3>{{ task.title }}</h3>
          <div class="task-actions">
            <button (click)="toggleComplete(task)">Mark Incomplete</button>
            <button (click)="deleteTask(task.id)">Delete</button>
          </div>
        </div>
        
        <p>{{ task.description }}</p>
        <div class="task-meta">
          <span>Deadline: {{ task.deadline | date:'mediumDate' }}</span>
          <span class="completed-label">COMPLETED</span>
        </div>
      </li>
    </ul>
  </div>
</div>
